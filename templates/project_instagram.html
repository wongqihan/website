<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Agent - {{ name }}</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .terminal-window {
            background-color: #1e1e1e;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            font-family: 'Courier New', Courier, monospace;
            overflow: hidden;
        }

        .terminal-header {
            background-color: #2d2d2d;
            padding: 10px 15px;
            display: flex;
            align-items: center;
        }

        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .dot-red {
            background-color: #ff5f56;
        }

        .dot-yellow {
            background-color: #ffbd2e;
        }

        .dot-green {
            background-color: #27c93f;
        }

        .terminal-body {
            padding: 20px;
            color: #d4d4d4;
            height: 300px;
            overflow-y: auto;
            font-size: 14px;
        }

        .log-line {
            margin-bottom: 5px;
            opacity: 0;
            animation: fadeIn 0.3s forwards;
        }

        .log-success {
            color: #4ec9b0;
        }

        .log-info {
            color: #569cd6;
        }

        .log-warning {
            color: #ce9178;
        }

        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }

        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800 font-sans">

    <!-- Navigation -->
    <nav class="bg-white shadow-sm">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <a href="/" class="text-xl font-bold text-blue-600">{{ name }}</a>
            <a href="/" class="text-gray-600 hover:text-blue-600"><i class="fas fa-arrow-left mr-2"></i> Back to
                Portfolio</a>
        </div>
    </nav>

    <!-- Project Header -->
    <header class="bg-white border-b">
        <div class="max-w-4xl mx-auto px-4 py-16">
            <div class="flex items-center mb-4">
                <span
                    class="bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full uppercase font-bold tracking-wide mr-3">Live
                    Demo</span>
                <span class="text-gray-500 text-sm">Python ‚Ä¢ Vertex AI ‚Ä¢ Flask</span>
            </div>
            <h1 class="text-4xl font-extrabold text-gray-900 mb-6">Instagram Automation Agent</h1>

            <div class="prose prose-lg text-gray-600 leading-relaxed">
                <p class="mb-6">
                    I manage a team of 5 AI Agents! ü§ñüêªüê∞ I have two childhood best friends: Bobo (a rabbit) and Stella
                    (a polar bear). I always imagined them having adventures while I was at work, but they aren't great
                    at taking photos. So, I built an autonomous team to do it for me.
                </p>

                <h3 class="text-xl font-bold text-gray-800 mb-3">My AI Org Chart:</h3>
                <ul class="list-none space-y-3 mb-8">
                    <li><span class="font-bold text-blue-600">üß† The Brain (Gemini 3):</span> Brainstorms a funny daily
                        plotline based on Bobo‚Äôs grumpy personality.</li>
                    <li><span class="font-bold text-purple-600">üé® The Artist (Vertex AI Imagen):</span> Renders
                        photorealistic assets, maintaining the specific worn-out boucl√© texture of the real toys.</li>
                    <li><span class="font-bold text-gray-800">ü§ñ The Orchestrator (Antigravity Agent):</span> The logic
                        layer that manages code, handles errors, and compiles assets.</li>
                    <li><span class="font-bold text-green-600">‚òÅÔ∏è The Vault (Google Cloud Storage):</span> Securely
                        hosts high-res assets for the API.</li>
                    <li><span class="font-bold text-pink-600">üöÄ The Publisher (Instagram Graph API):</span> Pushes the
                        final carousel live at 8 PM sharp.</li>
                </ul>

                <blockquote
                    class="border-l-4 border-blue-600 pl-4 italic text-gray-700 bg-gray-50 py-2 pr-4 rounded-r-lg">
                    "We might be entering an era of 'Synthetic Authenticity'‚Äîwhere the medium is AI, but the heart is
                    human."
                </blockquote>
            </div>
        </div>
    </header>

    <!-- Demo Section -->
    <section class="py-12">
        <div class="max-w-6xl mx-auto px-4">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">

                <!-- Left Column: Controls & Terminal -->
                <div>
                    <div class="bg-white p-8 rounded-xl shadow-sm border mb-8">
                        <h2 class="text-2xl font-bold mb-4">Run the Pipeline</h2>
                        <p class="text-gray-600 mb-6">Click below to trigger the live agent. It will generate a unique
                            story and images in real-time.</p>

                        <button id="runBtn"
                            class="w-full bg-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:bg-blue-700 transition shadow-lg flex items-center justify-center">
                            <span id="btnText">Start Generation</span>
                        </button>
                        <p class="text-xs text-gray-400 mt-3 text-center"><i class="fas fa-info-circle mr-1"></i>
                            Instagram posting is disabled for this public demo.</p>
                    </div>

                    <!-- Terminal View -->
                    <div class="terminal-window">
                        <div class="terminal-header">
                            <div class="terminal-dot dot-red"></div>
                            <div class="terminal-dot dot-yellow"></div>
                            <div class="terminal-dot dot-green"></div>
                            <span class="ml-4 text-gray-400 text-xs">agent_backend.py</span>
                        </div>
                        <div class="terminal-body" id="terminalOutput">
                            <div class="log-line text-gray-500">Waiting for trigger...</div>
                        </div>
                    </div>
                </div>

                <!-- Right Column: Results -->
                <div>
                    <h2 class="text-2xl font-bold mb-6">Generated Content</h2>

                    <!-- Story Card -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border mb-6">
                        <h3 class="text-sm font-bold text-gray-400 uppercase tracking-wider mb-3">Generated Story</h3>
                        <p id="storyOutput" class="text-gray-800 italic text-lg leading-relaxed">
                            (Story will appear here...)
                        </p>
                    </div>

                    <!-- Images Grid -->
                    <div class="grid grid-cols-2 gap-4" id="imageGrid">
                        <!-- Placeholders -->
                        <div
                            class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-400">
                            <i class="fas fa-image text-3xl"></i>
                        </div>
                        <div
                            class="aspect-square bg-gray-200 rounded-lg flex items-center justify-center text-gray-400">
                            <i class="fas fa-image text-3xl"></i>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </section>

    <script>
        const runBtn = document.getElementById('runBtn');
        const btnText = document.getElementById('btnText');
        const terminal = document.getElementById('terminalOutput');
        const storyOutput = document.getElementById('storyOutput');
        const imageGrid = document.getElementById('imageGrid');

        function addLog(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log-line log-${type}`;
            div.textContent = `> ${message}`;
            terminal.appendChild(div);
            terminal.scrollTop = terminal.scrollHeight;
        }

        runBtn.addEventListener('click', async () => {
            // Reset UI
            runBtn.disabled = true;
            btnText.innerHTML = '<div class="loader"></div> Running Agent...';
            runBtn.classList.add('opacity-75', 'cursor-not-allowed');
            terminal.innerHTML = '';
            storyOutput.textContent = '(Generating...)';
            imageGrid.innerHTML = `
                <div class="aspect-square bg-gray-200 rounded-lg animate-pulse"></div>
                <div class="aspect-square bg-gray-200 rounded-lg animate-pulse"></div>
            `;

            addLog("Initializing Agent Workflow...", "info");

            try {
                const response = await fetch('/api/run/instagram-agent', { method: 'POST' });
                const data = await response.json();

                if (data.status === 'success') {
                    // Update Logs
                    data.logs.forEach((log, index) => {
                        setTimeout(() => addLog(log, "success"), index * 500);
                    });

                    // Update Story
                    storyOutput.textContent = data.story;

                    // Update Images
                    imageGrid.innerHTML = data.images.map(url => `
                        <div class="aspect-square rounded-lg overflow-hidden shadow-md group relative">
                            <img src="${url}" class="w-full h-full object-cover transform group-hover:scale-105 transition duration-500" alt="Generated Image">
                        </div>
                    `).join('');

                    addLog("Workflow completed successfully!", "success");
                } else {
                    addLog(`Error: ${data.message}`, "warning");
                    storyOutput.textContent = "Error generating content.";
                }

            } catch (error) {
                addLog(`System Error: ${error.message}`, "warning");
            } finally {
                runBtn.disabled = false;
                btnText.textContent = 'Run Again';
                runBtn.classList.remove('opacity-75', 'cursor-not-allowed');
            }
        });
    </script>

</body>

</html>